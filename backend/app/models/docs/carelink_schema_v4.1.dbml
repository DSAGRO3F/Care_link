// =============================================================================
// CARELINK DATABASE SCHEMA v4.1
// Plateforme de coordination médico-sociale
// Généré le 2025-12-17
// =============================================================================
// Pour visualiser : https://dbdiagram.io/
// =============================================================================

Project CareLink {
  database_type: 'PostgreSQL'
  Note: '''
    # CareLink - Schéma de base de données v4.1
    
    Plateforme de coordination des soins à domicile pour les personnes âgées.
    Architecture multi-tenant SaaS.
    
    ## Modules
    - **Tenant** : Gestion multi-clients (tenants, abonnements, usage)
    - **Reference** : Données de référence (pays)
    - **Organization** : Structures médico-sociales (SSIAD, SAAD, GCSMS...)
    - **User** : Utilisateurs, rôles, professions, disponibilités
    - **Patient** : Dossier patient, évaluations, constantes vitales
    - **Catalog** : Catalogue national des services
    - **CarePlan** : Plans d aide et services planifiés
    - **Coordination** : Interventions planifiées et historique
  '''
}

// =============================================================================
// MODULE: TENANT - Architecture multi-clients
// =============================================================================

Table tenants {
  id integer [pk, increment]
  
  // Identification
  name varchar(200) [not null, note: 'Nom commercial du client']
  slug varchar(100) [not null, unique, note: 'Identifiant URL-friendly']
  
  // Domaine personnalisé
  custom_domain varchar(255) [unique, note: 'Ex: app.monssiad.fr']
  
  // Contact administratif
  admin_email varchar(255) [not null]
  admin_phone varchar(20)
  billing_email varchar(255)
  
  // Adresse de facturation
  billing_address_line1 varchar(255)
  billing_address_line2 varchar(255)
  billing_postal_code varchar(10)
  billing_city varchar(100)
  billing_country_id integer [ref: > countries.id]
  
  // Identifiants légaux
  siret varchar(14) [unique]
  vat_number varchar(20) [note: 'Numéro TVA intracommunautaire']
  
  // Configuration
  settings jsonb [default: '{}', note: 'Paramètres spécifiques du tenant']
  features_flags jsonb [default: '{}', note: 'Feature flags activés']
  timezone varchar(50) [not null, default: 'Europe/Paris']
  locale varchar(10) [not null, default: 'fr_FR']
  
  // Statut
  status tenant_status_enum [not null, default: 'ACTIVE']
  suspended_at timestamp
  suspension_reason text
  
  // Métadonnées
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  deleted_at timestamp [note: 'Soft delete']
  
  indexes {
    slug [unique]
    custom_domain [unique]
    status
  }
  
  Note: 'Clients de la plateforme CareLink (organisations clientes)'
}

Table subscriptions {
  id integer [pk, increment]
  
  // Référence tenant
  tenant_id integer [not null, ref: > tenants.id]
  
  // Plan et tarification
  plan_type subscription_plan_enum [not null, default: 'STARTER']
  billing_cycle billing_cycle_enum [not null, default: 'MONTHLY']
  price_cents integer [not null, note: 'Prix en centimes EUR']
  
  // Période
  trial_ends_at timestamp [note: 'Fin de période d essai']
  current_period_start timestamp [not null]
  current_period_end timestamp [not null]
  
  // Limites du plan
  max_users integer [not null, default: 10]
  max_patients integer [not null, default: 100]
  max_entities integer [not null, default: 1]
  max_storage_gb integer [not null, default: 5]
  max_api_calls_month integer [note: 'NULL = illimité']
  
  // Fonctionnalités incluses
  features jsonb [not null, default: '[]', note: 'Liste des features activées']
  
  // Paiement
  stripe_subscription_id varchar(100) [unique, note: 'ID Stripe']
  stripe_customer_id varchar(100) [note: 'Customer ID Stripe']
  payment_method payment_method_enum [default: 'CARD']
  last_payment_at timestamp
  last_payment_status payment_status_enum
  
  // Statut
  status subscription_status_enum [not null, default: 'TRIALING']
  cancelled_at timestamp
  cancellation_reason text
  
  // Métadonnées
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    status
    current_period_end
    stripe_subscription_id [unique]
  }
  
  Note: 'Abonnements des tenants'
}

Table subscription_usage {
  id integer [pk, increment]
  
  // Référence
  subscription_id integer [not null, ref: > subscriptions.id]
  
  // Période de mesure
  period_start date [not null]
  period_end date [not null]
  
  // Compteurs d utilisation
  users_count integer [not null, default: 0]
  active_users_count integer [not null, default: 0, note: 'Users connectés sur la période']
  patients_count integer [not null, default: 0]
  active_patients_count integer [not null, default: 0, note: 'Patients avec interventions']
  entities_count integer [not null, default: 0]
  
  // Stockage et API
  storage_bytes bigint [not null, default: 0]
  api_calls_count integer [not null, default: 0]
  
  // Interventions (métriques métier)
  interventions_count integer [not null, default: 0]
  care_plans_count integer [not null, default: 0]
  documents_generated_count integer [not null, default: 0]
  
  // Alertes de dépassement
  users_limit_reached boolean [not null, default: false]
  patients_limit_reached boolean [not null, default: false]
  storage_limit_reached boolean [not null, default: false]
  api_limit_reached boolean [not null, default: false]
  
  // Snapshot pour facturation
  snapshot_at timestamp [note: 'Date du dernier snapshot']
  is_final boolean [not null, default: false, note: 'Période clôturée']
  
  // Métadonnées
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    subscription_id
    (subscription_id, period_start, period_end) [unique, name: 'uq_usage_period']
    period_end
  }
  
  Note: 'Suivi de consommation des abonnements'
}

// =============================================================================
// MODULE: REFERENCE - Données de référence
// =============================================================================

Table countries {
  id integer [pk, increment]
  name varchar(100) [not null, unique]
  iso_code varchar(3) [not null, unique, note: 'Code ISO 3166-1 alpha-3']
  phone_prefix varchar(5) [note: 'Préfixe téléphonique (+33)']
  is_active boolean [not null, default: true]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  Note: 'Référentiel des pays'
}

// =============================================================================
// MODULE: ORGANIZATION - Structures organisationnelles
// =============================================================================

Table entities {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Tenant propriétaire']
  
  // Identification
  name varchar(200) [not null]
  short_name varchar(50)
  entity_type entity_type_enum [not null, note: 'SSIAD, SAAD, GCSMS, EHPAD...']
  
  // Identifiants officiels
  finess_et varchar(9) [unique, note: 'FINESS Établissement (9 chiffres)']
  finess_ej varchar(9) [note: 'FINESS Entité Juridique']
  siret varchar(14) [unique]
  
  // Hiérarchie
  parent_id integer [ref: > entities.id, note: 'Entité parente (GCSMS)']
  integration_type integration_type_enum [note: 'MANAGED, FEDERATED, CONVENTION']
  
  // Contact
  address_line1 varchar(255)
  address_line2 varchar(255)
  postal_code varchar(10)
  city varchar(100)
  country_id integer [ref: > countries.id]
  phone varchar(20)
  email varchar(255)
  
  // Géolocalisation (v4.0)
  latitude decimal(10,7) [note: 'Latitude du siège']
  longitude decimal(10,7) [note: 'Longitude du siège']
  default_intervention_radius_km integer [default: 30, note: 'Rayon intervention par défaut']
  
  // Métadonnées
  status varchar(20) [not null, default: 'active']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    entity_type
    parent_id
    finess_et [unique]
    (tenant_id, name) [name: 'ix_entities_tenant_name']
  }
  
  Note: 'Structures médico-sociales (SSIAD, SAAD, GCSMS...)'
}

// =============================================================================
// MODULE: USER - Utilisateurs et professions
// =============================================================================

Table professions {
  id integer [pk, increment]
  name varchar(100) [not null, unique]
  code varchar(10) [unique, note: 'Code RPPS/ADELI']
  category profession_category_enum [note: 'MEDICAL, PARAMEDICAL, ADMINISTRATIVE']
  requires_rpps boolean [not null, default: true]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  Note: 'Professions de santé réglementées'
}

Table roles {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [ref: > tenants.id, note: 'NULL = rôle système global']
  
  name varchar(50) [not null]
  description text
  permissions jsonb [note: 'Liste des permissions']
  is_system boolean [not null, default: false, note: 'Rôle système non modifiable']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    (tenant_id, name) [unique, name: 'uq_role_tenant_name']
  }
  
  Note: 'Rôles applicatifs (Admin, Coordinateur, Intervenant...)'
}

Table users {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Tenant principal']
  
  // Authentification
  email varchar(255) [not null, unique]
  hashed_password varchar(255) [not null]
  
  // Identité
  first_name varchar(100) [not null]
  last_name varchar(100) [not null]
  phone varchar(20)
  
  // Professionnel
  profession_id integer [ref: > professions.id]
  rpps_number varchar(11) [unique, note: 'Numéro RPPS (11 chiffres)']
  adeli_number varchar(9) [unique, note: 'Numéro ADELI (9 chiffres)']
  
  // Statut
  is_active boolean [not null, default: true]
  is_verified boolean [not null, default: false]
  last_login_at timestamp
  
  // Métadonnées
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    email [unique]
    profession_id
    rpps_number [unique]
    (tenant_id, email) [name: 'ix_users_tenant_email']
  }
  
  Note: 'Utilisateurs de la plateforme'
}

Table user_roles {
  id integer [pk, increment]
  user_id integer [not null, ref: > users.id]
  role_id integer [not null, ref: > roles.id]
  granted_at timestamp [not null, default: `now()`]
  granted_by integer [ref: > users.id]
  
  indexes {
    (user_id, role_id) [unique, name: 'uq_user_role']
  }
  
  Note: 'Association utilisateurs-rôles'
}

Table user_entities {
  id integer [pk, increment]
  user_id integer [not null, ref: > users.id]
  entity_id integer [not null, ref: > entities.id]
  
  // Contrat
  contract_type contract_type_enum [not null, note: 'SALARIE, LIBERAL, VACATION...']
  start_date date [not null]
  end_date date
  
  // Capacités (v4.0)
  intervention_radius_km integer [note: 'Rayon personnalisé (NULL = défaut entité)']
  max_daily_patients integer [note: 'Max patients/jour']
  max_weekly_hours integer [note: 'Max heures/semaine']
  default_start_time time [note: 'Heure début par défaut']
  default_end_time time [note: 'Heure fin par défaut']
  
  is_primary boolean [not null, default: false, note: 'Rattachement principal']
  is_active boolean [not null, default: true]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    (user_id, entity_id) [unique]
    entity_id
  }
  
  Note: 'Rattachement utilisateurs aux entités'
}

Table user_availabilities {
  id integer [pk, increment]
  user_id integer [not null, ref: > users.id]
  entity_id integer [ref: > entities.id, note: 'NULL = toutes entités']
  
  // Créneau
  day_of_week integer [not null, note: '1=Lundi, 7=Dimanche']
  start_time time [not null]
  end_time time [not null]
  
  // Récurrence
  is_recurring boolean [not null, default: true]
  valid_from date
  valid_until date
  
  // Capacité
  max_patients integer
  notes text
  is_active boolean [not null, default: true]
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    user_id
    entity_id
    day_of_week
  }
  
  Note: 'Disponibilités récurrentes des professionnels'
}

// =============================================================================
// MODULE: PATIENT - Dossier patient
// =============================================================================

Table patients {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Tenant propriétaire']
  
  // Identité
  first_name varchar(100) [not null]
  last_name varchar(100) [not null]
  birth_date date [not null]
  gender varchar(1) [note: 'M, F, O']
  
  // Contact
  phone varchar(20)
  email varchar(255)
  
  // Adresse
  address_line1 varchar(255)
  address_line2 varchar(255)
  postal_code varchar(10)
  city varchar(100)
  country_id integer [ref: > countries.id]
  
  // Géolocalisation (v4.0)
  latitude decimal(10,7) [note: 'Latitude domicile']
  longitude decimal(10,7) [note: 'Longitude domicile']
  geo_validated_at timestamp [note: 'Date validation géoloc']
  
  // Référent
  primary_entity_id integer [ref: > entities.id, note: 'Entité principale']
  
  // Statut
  status patient_status_enum [not null, default: 'ACTIVE']
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    primary_entity_id
    status
    (last_name, first_name)
    (tenant_id, status) [name: 'ix_patients_tenant_status']
  }
  
  Note: 'Dossiers patients'
}

Table patient_access {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  user_id integer [not null, ref: > users.id]
  access_type access_type_enum [not null, note: 'READ, WRITE, FULL']
  granted_at timestamp [not null, default: `now()`]
  granted_by integer [ref: > users.id]
  expires_at timestamp
  is_active boolean [not null, default: true]
  
  indexes {
    (patient_id, user_id) [unique]
  }
  
  Note: 'Droits d accès au dossier patient'
}

Table patient_evaluations {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  evaluator_id integer [not null, ref: > users.id]
  
  // Type et données
  schema_type evaluation_schema_type_enum [not null]
  schema_version varchar(10) [not null, default: '1.0']
  evaluation_data jsonb [not null, note: 'Données JSON Schema']
  
  // Résultats
  gir_score integer [note: 'Score GIR calculé (1-6)']
  
  // Validation
  validated_at timestamp
  validated_by integer [ref: > users.id]
  
  // Métadonnées
  evaluated_at timestamp [not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    patient_id
    evaluator_id
    evaluated_at
  }
  
  Note: 'Évaluations patient (AGGIR, sociale, santé)'
}

Table patient_thresholds {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  vital_type vital_type_enum [not null]
  min_value decimal(10,2)
  max_value decimal(10,2)
  critical_min decimal(10,2)
  critical_max decimal(10,2)
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    (patient_id, vital_type) [unique]
  }
  
  Note: 'Seuils personnalisés des constantes vitales'
}

Table patient_devices {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  device_type device_type_enum [not null]
  device_id varchar(100) [note: 'Identifiant externe']
  device_name varchar(100)
  is_active boolean [not null, default: true]
  last_sync_at timestamp
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    patient_id
  }
  
  Note: 'Appareils connectés du patient'
}

Table patient_vitals {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  vital_type vital_type_enum [not null]
  value decimal(10,2) [not null]
  unit varchar(20)
  status vital_status_enum [not null, default: 'NORMAL']
  source vital_source_enum [not null, default: 'MANUAL']
  device_id integer [ref: > patient_devices.id]
  recorded_by integer [ref: > users.id]
  recorded_at timestamp [not null]
  notes text
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    patient_id
    vital_type
    recorded_at
  }
  
  Note: 'Constantes vitales du patient'
}

Table patient_documents {
  id integer [pk, increment]
  patient_id integer [not null, ref: > patients.id]
  document_type document_type_enum [not null]
  title varchar(255) [not null]
  description text
  
  // Génération LLM
  source_evaluation_id integer [ref: > patient_evaluations.id]
  generation_prompt text
  generation_context jsonb
  
  // Fichier
  file_path varchar(500) [not null]
  file_format document_format_enum [not null]
  file_size_bytes integer
  file_hash varchar(64) [note: 'SHA-256']
  
  // Métadonnées
  generated_at timestamp [not null]
  generated_by integer [not null, ref: > users.id]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    patient_id
    document_type
  }
  
  Note: 'Documents générés (PPA, PPCS, Recommandations)'
}

// =============================================================================
// MODULE: CATALOG - Catalogue des services
// =============================================================================

Table service_templates {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [ref: > tenants.id, note: 'NULL = catalogue national']
  
  // Identification
  code varchar(50) [not null, note: 'TOILETTE_COMPLETE, INJECTION_SC...']
  name varchar(100) [not null]
  category service_category_enum [not null]
  description text
  
  // Exigences
  required_profession_id integer [ref: > professions.id, note: 'NULL = polyvalent']
  required_qualification varchar(100)
  
  // Caractéristiques
  default_duration_minutes integer [not null, default: 30]
  requires_prescription boolean [not null, default: false]
  is_medical_act boolean [not null, default: false]
  apa_eligible boolean [not null, default: true]
  
  // Affichage
  display_order integer [not null, default: 100]
  status varchar(20) [not null, default: 'active']
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    (tenant_id, code) [unique, name: 'uq_service_template_tenant_code']
    category
    required_profession_id
  }
  
  Note: 'Catalogue national des types de prestations'
}

Table entity_services {
  id integer [pk, increment]
  entity_id integer [not null, ref: > entities.id]
  service_template_id integer [not null, ref: > service_templates.id]
  
  // Paramètres
  is_active boolean [not null, default: true]
  price_euros decimal(10,2)
  max_capacity_week integer
  custom_duration_minutes integer
  notes text
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    (entity_id, service_template_id) [unique, name: 'uq_entity_service']
    entity_id
    service_template_id
  }
  
  Note: 'Services proposés par chaque entité'
}

// =============================================================================
// MODULE: CAREPLAN - Plans d aide
// =============================================================================

Table care_plans {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Tenant propriétaire']
  
  // Références
  patient_id integer [not null, ref: > patients.id]
  source_evaluation_id integer [ref: > patient_evaluations.id]
  entity_id integer [not null, ref: > entities.id]
  
  // Identification
  title varchar(200) [not null]
  reference_number varchar(50) [unique]
  
  // Statut
  status care_plan_status_enum [not null, default: 'DRAFT']
  
  // Période
  start_date date [not null]
  end_date date
  
  // Volumétrie
  total_hours_week decimal(5,2)
  gir_at_creation integer [note: 'GIR 1-6 à la création']
  
  // Validation
  validated_by_id integer [ref: > users.id]
  validated_at timestamp
  
  // Notes
  notes text
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  created_by integer [ref: > users.id]
  updated_by integer [ref: > users.id]
  
  indexes {
    tenant_id
    patient_id
    entity_id
    source_evaluation_id
    status
    (tenant_id, status) [name: 'ix_care_plans_tenant_status']
  }
  
  Note: 'Plans d aide patients'
}

Table care_plan_services {
  id integer [pk, increment]
  
  // Références
  care_plan_id integer [not null, ref: > care_plans.id]
  service_template_id integer [not null, ref: > service_templates.id]
  
  // Fréquence
  quantity_per_week integer [not null, default: 1]
  frequency_type frequency_type_enum [not null, default: 'WEEKLY']
  frequency_days jsonb [note: '[1,2,3,4,5] = Lun-Ven']
  
  // Créneau préféré
  preferred_time_start time
  preferred_time_end time
  duration_minutes integer [not null]
  
  // Priorité
  priority service_priority_enum [not null, default: 'MEDIUM']
  
  // Affectation
  assigned_user_id integer [ref: > users.id]
  assignment_status assignment_status_enum [not null, default: 'UNASSIGNED']
  assigned_at timestamp
  assigned_by_id integer [ref: > users.id]
  
  // Instructions
  special_instructions text
  status varchar(20) [not null, default: 'active']
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    care_plan_id
    service_template_id
    assigned_user_id
    assignment_status
  }
  
  Note: 'Services individuels des plans d aide'
}

// =============================================================================
// MODULE: COORDINATION - Interventions et historique
// =============================================================================

Table scheduled_interventions {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Dénormalisé pour perf requêtes']
  
  // Références
  care_plan_service_id integer [not null, ref: > care_plan_services.id]
  patient_id integer [not null, ref: > patients.id, note: 'Dénormalisé pour perf']
  user_id integer [ref: > users.id]
  
  // Planning prévu
  scheduled_date date [not null]
  scheduled_start_time time [not null]
  scheduled_end_time time [not null]
  
  // Statut
  status intervention_status_enum [not null, default: 'SCHEDULED']
  
  // Réalisation effective
  actual_start_time time
  actual_end_time time
  actual_duration_minutes integer
  
  // Notes
  completion_notes text
  cancellation_reason text
  
  // Lien historique
  coordination_entry_id integer [ref: > coordination_entries.id]
  
  // Reprogrammation
  rescheduled_from_id integer [ref: > scheduled_interventions.id]
  rescheduled_to_id integer [ref: > scheduled_interventions.id]
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    (tenant_id, scheduled_date) [name: 'ix_sched_interv_tenant_date']
    (user_id, scheduled_date) [name: 'ix_sched_interv_user_date']
    (patient_id, scheduled_date) [name: 'ix_sched_interv_patient_date']
    (scheduled_date, status) [name: 'ix_sched_interv_date_status']
    care_plan_service_id
    coordination_entry_id
    status
  }
  
  Note: 'Planning des interventions futures (RDV concrets)'
}

Table coordination_entries {
  id integer [pk, increment]
  
  // *** MULTI-TENANT ***
  tenant_id integer [not null, ref: > tenants.id, note: 'Tenant propriétaire']
  
  // Références
  patient_id integer [not null, ref: > patients.id]
  user_id integer [not null, ref: > users.id]
  
  // Catégorisation
  category coordination_category_enum [not null]
  intervention_type varchar(100) [not null]
  
  // Contenu
  description text [not null]
  observations text
  next_actions text
  
  // Horodatage
  performed_at timestamp [not null]
  duration_minutes integer
  
  // Soft delete
  deleted_at timestamp
  
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  indexes {
    tenant_id
    patient_id
    user_id
    performed_at
    category
    (tenant_id, performed_at) [name: 'ix_coord_entries_tenant_date']
  }
  
  Note: 'Historique des interventions réalisées (carnet de coordination)'
}

// =============================================================================
// ENUMS - Module TENANT
// =============================================================================

Enum tenant_status_enum {
  PENDING [note: 'En attente de validation']
  ACTIVE [note: 'Actif']
  SUSPENDED [note: 'Suspendu (impayé, violation CGU...)']
  CANCELLED [note: 'Résilié']
}

Enum subscription_plan_enum {
  FREE [note: 'Gratuit - fonctionnalités limitées']
  STARTER [note: 'Petite structure - 1 entité']
  PROFESSIONAL [note: 'Multi-entités']
  ENTERPRISE [note: 'Sur mesure - GCSMS']
}

Enum subscription_status_enum {
  TRIALING [note: 'Période d essai']
  ACTIVE [note: 'Actif']
  PAST_DUE [note: 'Paiement en retard']
  SUSPENDED [note: 'Suspendu']
  CANCELLED [note: 'Résilié']
  EXPIRED [note: 'Expiré']
}

Enum billing_cycle_enum {
  MONTHLY [note: 'Mensuel']
  QUARTERLY [note: 'Trimestriel']
  YEARLY [note: 'Annuel']
}

Enum payment_method_enum {
  CARD [note: 'Carte bancaire']
  SEPA [note: 'Prélèvement SEPA']
  INVOICE [note: 'Facture (entreprise)']
}

Enum payment_status_enum {
  PENDING [note: 'En attente']
  SUCCEEDED [note: 'Réussi']
  FAILED [note: 'Échoué']
  REFUNDED [note: 'Remboursé']
}

// =============================================================================
// ENUMS - Autres modules (existants)
// =============================================================================

Enum entity_type_enum {
  SSIAD
  SAAD
  SAD
  SPASAD
  SAP
  EHPAD
  RESIDENCE_AUTONOMIE
  ACCUEIL_JOUR
  FAM
  MAS
  SESSAD
  IME
  ESAT
  GCSMS
  DAC
  CPTS
  PCPE
  PCO
  HOSPITAL
  CLINIC
  CSI
  HAD
  HALTE_REPIT
  FORMATION
  OTHER
}

Enum integration_type_enum {
  MANAGED
  FEDERATED
  CONVENTION
  FINANCIAL_CONTROL
}

Enum profession_category_enum {
  MEDICAL
  PARAMEDICAL
  ADMINISTRATIVE
  SOCIAL
}

Enum contract_type_enum {
  SALARIE
  LIBERAL
  VACATION
  REMPLACEMENT
  BENEVOLE
  STAGIAIRE
  MUTUAL_POOL
}

Enum patient_status_enum {
  ACTIVE
  ARCHIVED
  DECEASED
  TRANSFERRED
}

Enum access_type_enum {
  READ
  WRITE
  FULL
}

Enum vital_type_enum {
  FC
  TA_SYS
  TA_DIA
  SPO2
  TEMPERATURE
  POIDS
  GLYCEMIE
  EVA_DOULEUR
}

Enum vital_status_enum {
  NORMAL
  LOW
  HIGH
  CRITICAL
}

Enum vital_source_enum {
  MANUAL
  DEVICE_AUTO
  DEVICE_MANUAL
  IMPORT
}

Enum device_type_enum {
  WITHINGS_SCALE
  WITHINGS_BPM
  APPLE_WATCH
  SAMSUNG_WATCH
  FREESTYLE_LIBRE
  OTHER
}

Enum evaluation_schema_type_enum {
  EVALUATION_COMPLETE
  AGGIR_ONLY
  SOCIAL_ONLY
  SANTE_ONLY
}

Enum document_type_enum {
  PPA
  PPCS
  RECOMMENDATION
  OTHER
}

Enum document_format_enum {
  PDF
  DOCX
  HTML
}

Enum service_category_enum {
  SOINS
  HYGIENE
  REPAS
  MOBILITE
  COURSES
  MENAGE
  ADMINISTRATIF
  SOCIAL
  AUTRE
}

Enum coordination_category_enum {
  SOINS
  HYGIENE
  REPAS
  MOBILITE
  ADMINISTRATIF
  SOCIAL
  MEDICAL
  MENAGE
  COURSES
  AUTRE
}

Enum care_plan_status_enum {
  DRAFT
  PENDING_VALIDATION
  ACTIVE
  SUSPENDED
  COMPLETED
  CANCELLED
}

Enum frequency_type_enum {
  DAILY
  WEEKLY
  SPECIFIC_DAYS
  MONTHLY
  ON_DEMAND
}

Enum service_priority_enum {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

Enum assignment_status_enum {
  UNASSIGNED
  PENDING
  ASSIGNED
  CONFIRMED
  REJECTED
}

Enum intervention_status_enum {
  SCHEDULED
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  MISSED
  RESCHEDULED
}
